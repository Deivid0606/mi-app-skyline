<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cat√°logo de Productos</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        :root { 
            --primary:#25D366; --primary-dark:#128C7E; --secondary:#FF6B6B; --accent:#FFD166; 
            --dark:#333; --light:#f8f9fa; --gray:#6c757d; --success:#28a745; --warning:#ffc107;
            --gradient: linear-gradient(135deg, var(--primary), var(--primary-dark));
        }
        body { background-color: var(--light); color: var(--dark); line-height: 1.6; }
        
        /* Header mejorado */
        header { 
            background: var(--gradient); 
            color:#fff; 
            text-align:center; 
            padding:2rem 1rem; 
            box-shadow:0 4px 20px rgba(0,0,0,.15); 
            position:relative; 
            overflow: hidden;
        }
        header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M11 18c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm48 25c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm-43-7c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm63 31c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM34 90c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm56-76c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM12 86c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm28-65c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm23-11c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-6 60c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm29 22c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zM32 63c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm57-13c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-9-21c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM60 91c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM35 41c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM12 60c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2z' fill='%23ffffff' fill-opacity='0.05' fill-rule='evenodd'/%3E%3C/svg%3E");
            opacity: 0.1;
        }
        h1 { font-size:2.5rem; margin-bottom:.5rem; font-weight: 800; text-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .subtitle { font-size:1.2rem; opacity:.9; margin-bottom: 1rem; }
        .trust-badges {
            display: flex;
            justify-content: center;
            gap: 1.5rem;
            margin-top: 1rem;
            flex-wrap: wrap;
        }
        .badge {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            background: rgba(255,255,255,0.2);
            padding: 0.5rem 1rem;
            border-radius: 50px;
            font-size: 0.9rem;
            backdrop-filter: blur(5px);
        }
        .admin-btn{ 
            position:absolute; 
            top:1rem; 
            right:1rem; 
            background:rgba(255,255,255,.2); 
            border:none; 
            color:#fff; 
            padding:.5rem 1rem; 
            border-radius:50px; 
            cursor:pointer; 
            transition:all .3s; 
            backdrop-filter: blur(5px);
            font-weight: 600;
        }
        .admin-btn:hover{ background:rgba(255,255,255,.3); transform: translateY(-2px); }
        
        .container{ max-width:1200px; margin:2rem auto; padding:0 1rem; }
        
        /* Tarjetas de productos mejoradas */
        .products-grid{ display:grid; grid-template-columns:repeat(auto-fill,minmax(280px,1fr)); gap:2rem; }
        .product-card{ 
            background:#fff; 
            border-radius:16px; 
            overflow:hidden; 
            box-shadow:0 6px 15px rgba(0,0,0,.08); 
            transition:all .4s ease; 
            cursor:pointer; 
            position: relative;
        }
        .product-card:hover{ 
            transform:translateY(-8px); 
            box-shadow:0 12px 25px rgba(0,0,0,.15); 
        }
        .product-badge {
            position: absolute;
            top: 12px;
            left: 12px;
            background: var(--secondary);
            color: white;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            z-index: 2;
        }
        .product-image-container{ 
            width:100%; 
            height:200px; 
            overflow:hidden; 
            display:flex; 
            align-items:center; 
            justify-content:center; 
            background:#f9f9f9; 
            position: relative;
        }
        .product-image{ width:100%; height:100%; object-fit:contain; padding:10px; transition: transform .5s ease; }
        .product-card:hover .product-image { transform: scale(1.05); }
        .product-info{ padding:1.5rem; }
        .product-title{ font-size:1.2rem; font-weight:600; margin-bottom:.5rem; color:var(--dark); height:3rem; overflow:hidden; }
        .product-price{ font-size:1.3rem; font-weight:700; color:var(--primary-dark); margin-bottom:.5rem; }
        .product-sku{ color:var(--gray); font-size:.9rem; margin-bottom:1rem; }
        .whatsapp-btn{ 
            display:flex; 
            align-items:center; 
            justify-content:center; 
            gap:8px; 
            width:100%; 
            padding:14px; 
            background:var(--gradient); 
            color:#fff; 
            border:none; 
            border-radius:10px; 
            font-size:1rem; 
            font-weight:600; 
            cursor:pointer; 
            transition:all .3s ease; 
            box-shadow: 0 4px 10px rgba(37, 211, 102, 0.3);
        }
        .whatsapp-btn:hover{ 
            background:var(--primary-dark); 
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(37, 211, 102, 0.4);
        }
        .share-btn{ 
            display:flex; 
            align-items:center; 
            justify-content:center; 
            gap:8px; 
            width:100%; 
            padding:12px; 
            background:var(--gray); 
            color:#fff; 
            border:none; 
            border-radius:8px; 
            font-size:0.9rem; 
            font-weight:600; 
            cursor:pointer; 
            transition:background-color .3s ease; 
            margin-top: 8px; 
        }
        .share-btn:hover{ background:#5a6268; }
        
        /* Landing Page mejorada */
        .landing-page{ 
            display:none; 
            position:fixed; 
            top:0; 
            left:0; 
            width:100%; 
            height:100%; 
            background:#fff; 
            z-index:1000; 
            overflow-y:auto; 
            padding:0;
        }
        .landing-header{ 
            display:flex; 
            justify-content:space-between; 
            align-items:center; 
            margin-bottom:2rem; 
            padding:1.5rem 2rem;
            background: var(--gradient);
            color: white;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        .close-btn{ 
            background:none; 
            border:none; 
            font-size:1.5rem; 
            cursor:pointer; 
            color:white;
            transition: transform .3s;
        }
        .close-btn:hover { transform: rotate(90deg); }
        .landing-content{ 
            display:flex; 
            flex-wrap:wrap; 
            gap:2rem; 
            padding: 2rem;
            max-width: 1200px;
            margin: 0 auto;
        }
        .landing-image-container{ 
            flex:1; 
            min-width:300px; 
            max-width:500px; 
            display:flex; 
            align-items:center; 
            justify-content:center; 
            background:#f9f9f9; 
            border-radius:16px; 
            padding:20px; 
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
        }
        .landing-image{ width:100%; max-height:400px; object-fit:contain; border-radius: 8px; }
        .landing-details{ flex:1; min-width:300px; }
        .landing-title{ font-size:2rem; margin-bottom:1rem; color:var(--dark); font-weight: 700; }
        .landing-price{ font-size:1.8rem; font-weight:700; color:var(--primary-dark); margin-bottom:.5rem; }
        .landing-sku{ color:var(--gray); margin-bottom:1.5rem; }
        .landing-description{ 
            margin-bottom:2rem; 
            line-height:1.8; 
            font-size: 1.1rem;
            padding: 1.5rem;
            background: #f8f9fa;
            border-radius: 10px;
            border-left: 4px solid var(--primary);
        }
        .features{ margin-bottom:2rem; }
        .features h3{ margin-bottom:1rem; color: var(--dark); font-weight: 600; }
        .features ul{ list-style-type:none; }
        .features li{ 
            margin-bottom:.8rem; 
            display:flex; 
            align-items:center; 
            padding: 0.5rem 0;
            border-bottom: 1px solid #f0f0f0;
        }
        .features li:before{ 
            content:"‚úì"; 
            color:var(--success); 
            font-weight:bold; 
            margin-right:.8rem; 
            font-size: 1.2rem;
        }
        
        /* Formulario mejorado */
        .purchase-form{ 
            background:#fff; 
            padding:2rem; 
            border-radius:16px; 
            box-shadow:0 8px 25px rgba(0,0,0,.08);
            border: 1px solid #eaeaea;
            position: relative;
        }
        .form-title{ 
            margin-bottom:1.5rem; 
            color:var(--dark); 
            font-size: 1.5rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        .form-title::before {
            content: '';
            display: block;
            width: 6px;
            height: 24px;
            background: var(--primary);
            border-radius: 3px;
        }
        .form-group{ margin-bottom:1.5rem; }
        .form-group label{ display:block; margin-bottom:.5rem; font-weight:600; color: #444; }
        .form-control{ 
            width:100%; 
            padding:14px; 
            border:2px solid #e0e0e0; 
            border-radius:10px; 
            font-size:1rem; 
            transition: all .3s;
        }
        .form-control:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(37, 211, 102, 0.2);
            outline: none;
        }
        .form-row{ display:flex; gap:1rem; }
        .form-row .form-group{ flex:1; }
        .total-price{ 
            background:var(--accent); 
            padding:1.2rem; 
            border-radius:10px; 
            margin:1.5rem 0; 
            text-align:center; 
            font-size:1.3rem; 
            font-weight:700; 
            color: #333;
            box-shadow: 0 4px 8px rgba(255, 209, 102, 0.3);
        }
        .submit-btn{ 
            display:flex; 
            align-items:center; 
            justify-content:center; 
            gap:8px; 
            width:100%; 
            padding:16px; 
            background:var(--gradient); 
            color:#fff; 
            border:none; 
            border-radius:10px; 
            font-size:1.1rem; 
            font-weight:600; 
            cursor:pointer; 
            transition:all .3s ease;
            box-shadow: 0 6px 15px rgba(37, 211, 102, 0.4);
            margin-bottom: 1rem;
        }
        .submit-btn:hover{ 
            background:var(--primary-dark); 
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(37, 211, 102, 0.5);
        }
        .urgency-banner {
            background: var(--secondary);
            color: white;
            padding: 0.8rem;
            border-radius: 8px;
            text-align: center;
            margin-bottom: 1.5rem;
            font-weight: 600;
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(255, 107, 107, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(255, 107, 107, 0); }
            100% { box-shadow: 0 0 0 0 rgba(255, 107, 107, 0); }
        }
        .trust-section {
            display: flex;
            justify-content: space-around;
            margin-top: 1.5rem;
            padding-top: 1.5rem;
            border-top: 1px solid #eaeaea;
        }
        .trust-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            gap: 0.5rem;
        }
        .trust-icon {
            font-size: 1.5rem;
            color: var(--primary);
        }
        .trust-text {
            font-size: 0.85rem;
            color: var(--gray);
        }
        .share-btn{ 
            display:flex; 
            align-items:center; 
            justify-content:center; 
            gap:8px; 
            width:100%; 
            padding:12px; 
            background:var(--gray); 
            color:#fff; 
            border:none; 
            border-radius:8px; 
            font-size:0.9rem; 
            font-weight:600; 
            cursor:pointer; 
            transition:background-color .3s ease; 
            margin-top: 8px; 
        }
        .share-btn:hover{ background:#5a6268; }
        
        /* Resto del CSS se mantiene igual */
        .admin-panel{ display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,.8); z-index:2000; justify-content:center; align-items:center; }
        .admin-content{ background:#fff; padding:2rem; border-radius:10px; width:90%; max-width:900px; max-height:90vh; overflow-y:auto; }
        .admin-header{ display:flex; justify-content:space-between; align-items:center; margin-bottom:1.5rem; padding-bottom:1rem; border-bottom:1px solid #eee; }
        .pin-form{ margin-bottom:2rem; padding:1.5rem; background:#f8f9fa; border-radius:8px; }
        .pin-input{ display:flex; gap:.5rem; margin-bottom:1rem; }
        .pin-input input{ width:50px; height:50px; text-align:center; font-size:1.5rem; border:2px solid #ddd; border-radius:5px; }
        .pin-input input:focus{ border-color:var(--primary); outline:none; }
        .add-product-form{ display:none; }
        .products-list{ margin-top:2rem; max-height:400px; overflow-y:auto; }
        .product-item{ display:flex; justify-content:space-between; align-items:center; padding:1rem; border-bottom:1px solid #eee; }
        .product-item:last-child{ border-bottom:none; }
        .product-item-info{ flex:1; }
        .product-item-title{ font-weight:600; margin-bottom:.25rem; }
        .product-item-sku{ color:var(--gray); font-size:.9rem; }
        .product-item-price{ margin:.5rem 0; font-weight:600; color:var(--primary-dark); }
        .edit-price-form{ display:flex; gap:.5rem; margin-top:.5rem; }
        .edit-price-input{ width:120px; padding:5px; border:1px solid #ddd; border-radius:3px; }
        .edit-price-btn{ background:var(--primary); color:#fff; border:none; padding:5px 10px; border-radius:3px; cursor:pointer; }
        .admin-buttons{ display:flex; gap:.5rem; }
        .edit-btn{ background:var(--primary); color:#fff; border:none; padding:.5rem 1rem; border-radius:5px; cursor:pointer; }
        .delete-btn{ background:var(--secondary); color:#fff; border:none; padding:.5rem 1rem; border-radius:5px; cursor:pointer; }
        footer{ text-align:center; padding:2rem; margin-top:3rem; background:var(--dark); color:#fff; }
        .search-container{ margin-bottom:2rem; display:flex; gap:1rem; }
        .search-input{ flex:1; padding:12px; border:1px solid #ddd; border-radius:5px; font-size:1rem; }
        .filter-select{ padding:12px; border:1px solid #ddd; border-radius:5px; font-size:1rem; background:#fff; }
        .no-products{ text-align:center; padding:3rem; color:var(--gray); grid-column:1 / -1; }
        @media (max-width:768px){
            .products-grid{ grid-template-columns:repeat(auto-fill,minmax(250px,1fr)); gap:1.5rem; }
            h1{ font-size:2rem; }
            .landing-content{ flex-direction:column; padding: 1rem; }
            .landing-header { padding: 1rem; }
            .form-row{ flex-direction:column; gap:0; }
            .admin-btn{ position:static; margin-top:1rem; }
            .product-item{ flex-direction:column; align-items:flex-start; gap:1rem; }
            .admin-buttons{ width:100%; justify-content:flex-end; }
            .search-container{ flex-direction:column; }
            .trust-badges { gap: 0.5rem; }
            .badge { font-size: 0.8rem; padding: 0.4rem 0.8rem; }
        }
        @media (max-width:480px){
            .products-grid{ grid-template-columns:1fr; }
            h1{ font-size:1.8rem; }
            .landing-page{ padding:0; }
            .pin-input input{ width:40px; height:40px; }
            .trust-section { flex-direction: column; gap: 1rem; }
        }
        .danger-btn{ background: var(--secondary); color:#fff; border:none; padding:.5rem 1rem; border-radius:6px; font-weight:600; }
    </style>
</head>
<body>
    <header>
        <h1>Cat√°logo de Productos</h1>
        <p class="subtitle">Consulta por cualquiera de nuestros productos por WhatsApp</p>
        <div class="trust-badges">
            <div class="badge"><i class="fas fa-shipping-fast"></i> Env√≠os a todo el pa√≠s</div>
            <div class="badge"><i class="fas fa-lock"></i> Pago seguro</div>
            <div class="badge"><i class="fas fa-headset"></i> Soporte 24/7</div>
        </div>
        <button class="admin-btn" id="admin-btn"><i class="fas fa-cog"></i> Administrar</button>
    </header>

    <div class="container">
        <div class="search-container">
            <input type="text" class="search-input" id="search-input" placeholder="Buscar productos...">
            <select class="filter-select" id="price-filter">
                <option value="">Filtrar por precio</option>
                <option value="low">Menor precio primero</option>
                <option value="high">Mayor precio primero</option>
            </select>
        </div>
        <div class="products-grid" id="products-container"></div>
    </div>

    <!-- Landing Page Mejorada -->
    <div class="landing-page" id="landing-page">
        <div class="landing-header">
            <h2 id="landing-product-title">Nombre del Producto</h2>
            <button class="close-btn" id="close-landing"><i class="fas fa-times"></i></button>
        </div>
        <div class="landing-content">
            <div class="landing-image-container">
                <img id="landing-product-image" src="" alt="Producto" class="landing-image">
            </div>
            <div class="landing-details">
                <h3 class="landing-title" id="landing-product-name">Nombre del Producto</h3>
                <p class="landing-price" id="landing-product-price">Gs. 0</p>
                <p class="landing-sku" id="landing-product-sku">SKU: XXX-XXX</p>
                
                <div class="urgency-banner">
                    <i class="fas fa-bolt"></i> ¬°Oferta especial! Solo quedan 5 unidades
                </div>
                
                <div class="landing-description" id="landing-product-description"></div>
                <div class="features">
                    <h3>Caracter√≠sticas principales:</h3>
                    <ul id="landing-product-features"></ul>
                </div>
                
                <div class="purchase-form">
                    <h3 class="form-title">Completa el formulario para comprar</h3>
                    
                    <form id="purchase-form">
                        <div class="form-group">
                            <label for="customer-name">Nombre y Apellido</label>
                            <input type="text" id="customer-name" class="form-control" required placeholder="Ej: Mar√≠a Gonz√°lez">
                        </div>
                        <div class="form-group">
                            <label for="customer-phone">Tel√©fono</label>
                            <input type="tel" id="customer-phone" class="form-control" required placeholder="Ej: 0981 123 456">
                        </div>
                        <div class="form-group">
                            <label for="customer-quantity">Cantidad</label>
                            <select id="customer-quantity" class="form-control" required>
                                <option value="">Selecciona la cantidad</option>
                                <option value="1">1 unidad</option>
                                <option value="2">2 unidades</option>
                                <option value="3">3 unidades</option>
                                <option value="4">4 unidades</option>
                                <option value="5">5 unidades</option>
                                <option value="6">6 unidades</option>
                                <option value="7">7 unidades</option>
                                <option value="8">8 unidades</option>
                                <option value="9">9 unidades</option>
                                <option value="10">10 unidades</option>
                                <option value="mas">M√°s de 10 unidades</option>
                            </select>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="customer-address">Direcci√≥n de env√≠o</label>
                                <input type="text" id="customer-address" class="form-control" required placeholder="Ej: Av. Espa√±a 1234">
                            </div>
                            <div class="form-group">
                                <label for="customer-city">Ciudad</label>
                                <input type="text" id="customer-city" class="form-control" required placeholder="Ej: Asunci√≥n">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="customer-message">Mensaje adicional (opcional)</label>
                            <textarea id="customer-message" class="form-control" rows="3" placeholder="Ej: ¬øTienen disponible en otro color?"></textarea>
                        </div>
                        <div class="total-price" id="total-price">Total a pagar: Gs. 0</div>
                        <button type="submit" class="submit-btn">
                            <i class="fab fa-whatsapp"></i> Comprar ahora por WhatsApp
                        </button>
                        <button type="button" class="share-btn" id="share-product-btn">
                            <i class="fas fa-share-alt"></i> Compartir este producto
                        </button>
                    </form>
                    
                    <div class="trust-section">
                        <div class="trust-item">
                            <i class="fas fa-shield-alt trust-icon"></i>
                            <span class="trust-text">Pago seguro</span>
                        </div>
                        <div class="trust-item">
                            <i class="fas fa-truck trust-icon"></i>
                            <span class="trust-text">Env√≠o gratis</span>
                        </div>
                        <div class="trust-item">
                            <i class="fas fa-undo trust-icon"></i>
                            <span class="trust-text">Devoluci√≥n f√°cil</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Admin Panel (sin cambios) -->
    <div class="admin-panel" id="admin-panel">
        <div class="admin-content">
            <div class="admin-header">
                <h2>Panel de Administraci√≥n</h2>
                <button class="close-btn" id="close-admin"><i class="fas fa-times"></i></button>
            </div>

            <div class="pin-form" id="pin-form">
                <h3>Ingresa el PIN de acceso</h3>
                <div class="pin-input">
                    <input type="password" maxlength="1" id="pin1" class="pin-digit">
                    <input type="password" maxlength="1" id="pin2" class="pin-digit">
                    <input type="password" maxlength="1" id="pin3" class="pin-digit">
                    <input type="password" maxlength="1" id="pin4" class="pin-digit">
                </div>
                <button class="submit-btn" id="verify-pin">Verificar PIN</button>
                <p id="pin-error" style="color:red;margin-top:1rem;display:none;">PIN incorrecto. Intenta nuevamente.</p>
            </div>

            <div class="add-product-form" id="add-product-form">
                <div style="display:flex; justify-content:space-between; align-items:center; gap:1rem; margin-bottom:1rem;">
                    <h3>Agregar Nuevo Producto</h3>
                    <button id="reset-catalog-btn" class="danger-btn"><i class="fas fa-rotate"></i> Reiniciar cat√°logo</button>
                </div>
                <form id="new-product-form">
                    <div class="form-group">
                        <label for="new-product-title">Nombre del Producto</label>
                        <input type="text" id="new-product-title" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="new-product-sku">SKU (debe ser √∫nico)</label>
                        <input type="text" id="new-product-sku" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="new-product-price">Precio (Guaran√≠es)</label>
                        <input type="number" id="new-product-price" class="form-control" min="0" required>
                    </div>
                    <div class="form-group">
                        <label for="new-product-image">URL de la Imagen</label>
                        <input type="url" id="new-product-image" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="new-product-description">Descripci√≥n del Producto</label>
                        <textarea id="new-product-description" class="form-control" rows="4" required></textarea>
                    </div>
                    <div class="form-group">
                        <label for="new-product-features">Caracter√≠sticas (separadas por comas)</label>
                        <input type="text" id="new-product-features" class="form-control" placeholder="Ej: Alta calidad, Duradero, Port√°til" required>
                    </div>
                    <button type="submit" class="submit-btn"><i class="fas fa-plus"></i> Agregar Producto</button>
                </form>

                <div class="products-list">
                    <h3>Productos Actuales</h3>
                    <div id="admin-products-list"></div>
                </div>
            </div>
        </div>
    </div>

    <footer><p>&copy; 2025 Cat√°logo de Productos. Todos los derechos reservados.</p></footer>

    <script>
        // ================== AIRBAGS DE DIAGN√ìSTICO ==================
        window.addEventListener('error', (e) => {
            console.error('Error global:', e.error || e.message);
            alert('Ocurri√≥ un error inesperado. Revisa la consola (F12) para detalles.');
        });
        window.addEventListener('unhandledrejection', (e) => {
            console.error('Promise no manejada:', e.reason);
            alert('Ocurri√≥ un error inesperado (promesa). Revisa la consola.');
        });

        // ===== Persistencia =====
        const STORAGE_KEY = 'catalog_products_v3'; // Cambiado a v3 para forzar recarga

        function saveProductsToStorage() {
            try {
                const payload = JSON.stringify(products);
                localStorage.setItem(STORAGE_KEY, payload);
                console.log('Productos guardados:', products.length);
            } catch(e){
                console.warn('No se pudo guardar en localStorage:', e);
                try { sessionStorage.setItem(STORAGE_KEY, JSON.stringify(products)); } catch(_) {}
                alert('Error al guardar productos. Los datos podr√≠an perderse al recargar.');
            }
        }

        function loadProductsFromStorage() {
            try {
                const raw = localStorage.getItem(STORAGE_KEY) || sessionStorage.getItem(STORAGE_KEY);
                if (raw) {
                    const arr = JSON.parse(raw);
                    if (Array.isArray(arr)) {
                        products = arr;
                        console.log('Productos cargados:', products.length);
                        return true;
                    }
                }
            } catch(e){
                console.warn('No se pudo leer Storage:', e);
            }
            return false;
        }

        // ===== Datos iniciales (por defecto) - CORREGIDOS =====
        const DEFAULT_PRODUCTS = [
            {"title":"MINI ASPIRADORA","sku":"ASP-001","price":129900,"image_url":"https://cdn.shopify.com/s/files/1/0885/3012/5095/files/ChatGPT_Image_9_ago_2025_09_49_46_p.m._ee0d4101-4eb8-45cf-9b23-e5e1d8c6288c.png?v=1755580613","description":"Mini aspiradora port√°til y potente, ideal para limpiar espacios peque√±os, el auto o lugares de dif√≠cil acceso. Con bater√≠a recargable y m√∫ltiples accesorios.","features":["Port√°til y ligera","Bater√≠a recargable","M√∫ltiples accesorios","F√°cil de usar"]},
            {"title":"V-SHAPED - CINTA FACIAL","sku":"V-S-002","price":120000,"image_url":"https://cdn.shopify.com/s/files/1/0707/1979/9484/files/Imagen_de_WhatsApp_2025-10-12_a_las_12.59.36_b6026cac.jpg?v=1760415021","description":"Cinta facial V-Shaped para lifting facial instant√°neo. Ayuda a reducir la apariencia de arrugas y define el contorno facial.","features":["Lifting instant√°neo","Reduce arrugas","Define contorno facial","F√°cil aplicaci√≥n"]},
            {"title":"NIVELADORAS X 4","sku":"NIVE-003","price":99000,"image_url":"https://cdn.shopify.com/s/files/1/0885/3012/5095/files/D_NQ_NP_928396-MLA76742057946_062024-O_184afc35-97d9-4de7-a312-68808e057481.webp?v=1757838613","description":"Set de 4 niveladoras profesionales para trabajos de construcci√≥n y bricolaje. Precisi√≥n garantizada y f√°cil de usar.","features":["Set de 4 unidades","Precisi√≥n profesional","Duraderas","Para m√∫ltiples usos"]},
            {"title":"PLANTILLA ORTOP√âDICA | ORTOFLEX 5D¬Æ","sku":"ORTOPIEX-004","price":159000,"image_url":"https://cdn.shopify.com/s/files/1/0885/3012/5095/files/ChatGPT_Image_8_jun_2025_01_04_14_a.m._7b2cf86c-8fe2-44ec-a98a-2f3be15ebfe9.png?v=1757832927","description":"Plantillas ortop√©dicas Ortoflex 5D con tecnolog√≠a de amortiguaci√≥n avanzada. Alivian el dolor de pies y espalda, mejorando la postura.","features":["Tecnolog√≠a 5D","Amortiguaci√≥n avanzada","Alivia dolores","Mejora postura"]},
            {"title":"MINI CAMARA SPY","sku":"SPY-005","price":179000,"image_url":"https://cdn.shopify.com/s/files/1/0885/3012/5095/files/Captura_de_pantalla_2025-07-21_013411.png?v=1757887583","description":"Mini c√°mara esp√≠a de alta definici√≥n, discreta y f√°cil de ocultar. Ideal para seguridad dom√©stica o vigilancia.","features":["Alta definici√≥n","Discreta","F√°cil de ocultar","Bater√≠a de larga duraci√≥n"]},
            {"title":"LINTERNA POTENTE CON ZOOM","sku":"LINT-006","price":189000,"image_url":"https://acdn-us.mitiendanube.com/stores/001/131/056/products/linterr1-883f44649ed5698ece16878282190084-640-0.jpg","description":"Linterna potente con zoom ajustable, ideal para camping, emergencias o trabajos de precisi√≥n. Alcance de hasta 500 metros.","features":["Zoom ajustable","Alcance 500m","Resistente al agua","Bater√≠a recargable"]},
            {"title":"COMBO DE PERFUMES / ONE MILLION / 212","sku":"PEFUM-007","price":369000,"image_url":"https://cdn.shopify.com/s/files/1/0707/1979/9484/files/WhatsApp_Image_2025-05-12_at_19.24.47.jpg?v=1758052245","description":"Combo exclusivo de perfumes One Million y 212. Fragancias duraderas y elegantes para ocasiones especiales.","features":["Fragancias exclusivas","Duraderas","Elegantes","Combo especial"]},
            {"title":"SOPORTE REGULABLE PARA ELECTRODOMESTICOS","sku":"SOP-008","price":145000,"image_url":"https://cdn.shopify.com/s/files/1/0707/1979/9484/files/Captura_de_pantalla_2025-08-31_013252.png?v=1756670358","description":"Soporte regulable para electrodom√©sticos, ideal para microondas, air fryers y otros dispositivos de cocina. Ahorra espacio y organiza tu cocina.","features":["Regulable","Ahorra espacio","F√°cil instalaci√≥n","Material resistente"]},
            {"title":"PISTOLA MASAJEADORA","sku":"PIS-010","price":169000,"image_url":"https://http2.mlstatic.com/D_NQ_NP_863788-MLA78270636317_082024-O.webp","description":"Pistola masajeadora profesional para aliviar tensiones musculares. M√∫ltiples cabezales y velocidades para un masaje personalizado.","features":["Profesional","M√∫ltiples cabezales","Velocidades ajustables","Alivia tensiones"]},
            {"title":"CORRECTOR DE POSTURA X","sku":"CORREC-011","price":179000,"image_url":"https://www.skylinestoree.online/cdn/shop/files/fajacorrectora3_540x_d6e03ef1-f416-4751-aba8-e8d3bd49dd95.jpg?v=1752811848&width=600","description":"Corrector de postura ergon√≥mico que ayuda a mantener una postura correcta durante el d√≠a. Ideal para personas que trabajan sentadas.","features":["Ergon√≥mico","Ajustable","Material transpirable","Mejora postura"]},
            {"title":"üíôü¶∂ Pack Bienestar: 2 Pares de Medias Terap√©uticas","sku":"MEDIA-012","price":120000,"image_url":"https://jv7dta-ka.myshopify.com/cdn/shop/files/ChatGPTImage19ago2025_01_50_42a.m..png?v=1755579070&width=600","description":"Pack de 2 pares de medias terap√©uticas que mejoran la circulaci√≥n y reducen la fatiga en los pies. Ideales para uso diario.","features":["Mejora circulaci√≥n","Reduce fatiga","Pack de 2 pares","Material transpirable"]},
            {"title":"COMBO DIOSA","sku":"COMBO-DIOSA-013","price":295000,"image_url":"https://jv7dta-ka.myshopify.com/cdn/shop/files/Captura_de_pantalla_2025-07-22_020430_abbf3cfe-023e-4117-b3c6-284092688429.png?v=1753160734&width=493","description":"Combo Diosa con productos de belleza y cuidado personal seleccionados para realzar tu belleza natural.","features":["Productos seleccionados","Cuidado personal","Realza belleza","Combo exclusivo"]},
            {"title":"Mini GPS con im√°n y bater√≠a ‚ú® Geo Ultra","sku":"GPS-014","price":185000,"image_url":"https://jv7dta-ka.myshopify.com/cdn/shop/files/S86697bbae4184a99a675f0ad713badd8d.webp?v=1750465534&width=600","description":"Mini GPS con im√°n incorporado y bater√≠a de larga duraci√≥n. Ideal para localizar objetos importantes o mascotas.","features":["Con im√°n","Bater√≠a larga duraci√≥n","Aplicaci√≥n m√≥vil","Localizaci√≥n en tiempo real"]},
            {"title":"KIT PERFUMES: ONE MILLON, BLUE, SAUVAGE","sku":"SAUVAGE-015","price":369000,"image_url":"https://cdn.shopify.com/s/files/1/0707/1979/9484/files/Captura_de_pantalla_2025-09-19_145822.jpg?v=1758304744","description":"Kit de perfumes con las fragancias One Million, Blue y Sauvage. Tres opciones para diferentes ocasiones y estilos.","features":["Tres fragancias","Para diferentes ocasiones","Elegantes","Duraderas"]},
            {"title":"Corte Fino/ Afilador de Cuchillos y Tijerasüî™‚úÇÔ∏è","sku":"AFI-016","price":109000,"image_url":"https://jv7dta-ka.myshopify.com/cdn/shop/files/afilador1.webp?v=1753405987&width=600","description":"Afilador profesional para cuchillos y tijeras. Mant√©n tus herramientas de corte siempre afiladas y listas para usar.","features":["Para cuchillos y tijeras","F√°cil de usar","Resultados profesionales","Seguro"]},
            {"title":"COMBO PERFUMES X2 BAD BOY + INVICTUS","sku":"BADBOY-017","price":369000,"image_url":"https://jv7dta-ka.myshopify.com/cdn/shop/files/Post_para_instagram_datos_de_pago_moderno_azul_2.png?v=1753396867&width=600","description":"Combo de perfumes Bad Boy e Invictus. Fragancias masculinas intensas y seductoras para el hombre moderno.","features":["Fragancias masculinas","Intensas","Seductoras","Combo especial"]},
            {"title":"CREMA PARA HONGO","sku":"HONGO-018","price":120000,"image_url":"https://cdn.shopify.com/s/files/1/0707/1979/9484/files/WhatsApp_Image_2025-06-30_at_02.07.48.jpg?v=1758810936","description":"Crema antif√∫ngica efectiva para el tratamiento de hongos en la piel. F√≥rmula cl√≠nicamente probada para resultados r√°pidos.","features":["Antif√∫ngica","Resultados r√°pidos","F√≥rmula probada","F√°cil aplicaci√≥n"]},
            {"title":"PLANTILLA NAFOING","sku":"NAF-019","price":129900,"image_url":"https://digital-world.in.ua/wa-data/public/shop/products/73/21/2173/images/9980/9980.970.jpg","description":"Plantillas NAFOING con tecnolog√≠a de amortiguaci√≥n y soporte arqueado. Ideales para el confort diario y la salud de tus pies.","features":["Amortiguaci√≥n avanzada","Soporte arqueado","Confort diario","Material de calidad"]},
            {"title":"HIDROLAVADORA PORTATIL","sku":"HIDRO-020","price":295000,"image_url":"https://cdn.shopify.com/s/files/1/0707/1979/9484/files/Captura_de_pantalla_2025-11-05_201420.jpg?v=1762384557","description":"Hidrolavadora port√°til con potencia profesional. Ideal para limpiar autos, bicicletas, muebles y m√°s. F√°cil de transportar y usar.","features":["Port√°til","Potencia profesional","F√°cil de usar","M√∫ltiples usos"]},
            {"title":"LUCES NAVIDE√ëAS COLORIDAS CON PANEL SOLAR 20 METROS BLANCO","sku":"LUCNAVI-021","price":159900,"image_url":"https://cdn.shopify.com/s/files/1/0707/1979/9484/files/Imagen_de_WhatsApp_2025-09-25_a_las_01.03.55_e8205f5b.jpg?v=1759102624","description":"Luces navide√±as coloridas de 10 metros con panel solar. Decoraci√≥n ecol√≥gica y econ√≥mica para tus fiestas.","features":["Panel solar","10 metros de longitud","Colores vibrantes","Ecol√≥gico"]},
            {"title":"PARLANTE TIPO JBL G4","sku":"JBL-022","price":620000,"image_url":"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSs0vkbIqtSK_Qufj8C9Y2Lf3Y0kUlelJTQJg&s","description":"Parlante Bluetooth tipo JBL G4 con sonido de alta calidad y bater√≠a de larga duraci√≥n. Ideal para fiestas y reuniones.","features":["Sonido de alta calidad","Bater√≠a larga duraci√≥n","Bluetooth","Dise√±o port√°til"]},
            {"title":"SUPER COMBO 3x1 de Perfumes para Mujeres 30MLüå∏","sku":"PER30ML-023","price":269000,"image_url":"https://jv7dta-ka.myshopify.com/cdn/shop/files/ChatGPT_Image_15_jul_2025_03_10_36_p.m..png?v=1752603067&width=713","description":"Super combo 3x1 de perfumes para mujeres en presentaci√≥n de 30ml. Tres fragancias elegantes y femeninas en un solo pack.","features":["Tres fragancias","Presentaci√≥n 30ml","Elegantes","Femeninas"]},
            {"title":"RoyalBee Wax CERA PARA MADERA Y CUERO‚ú®","sku":"BEEWAS-024","price":120000,"image_url":"https://jv7dta-ka.myshopify.com/cdn/shop/files/ChatGPT_Image_4_oct_2025_03_57_23_p.m..png?v=1759604271&width=600","description":"Cera RoyalBee para el cuidado y protecci√≥n de madera y cuero. Restaura el brillo natural y protege contra el desgaste.","features":["Para madera y cuero","Restaura brillo","Protege del desgaste","F√°cil aplicaci√≥n"]},
            {"title":"Lampara Solar + kit De Herramienta","sku":"LINKINT-025","price":169000,"image_url":"https://cdn.shopify.com/s/files/1/0707/1979/9484/files/Imagen_de_WhatsApp_2025-10-11_a_las_23.38.41_6c489671.jpg?v=1760236797","description":"L√°mpara solar con kit de herramientas incluido. Iluminaci√≥n ecol√≥gica y herramientas b√°sicas para el hogar.","features":["Energ√≠a solar","Kit de herramientas","Ecol√≥gica","Pr√°ctica"]},
            {"title":"SOMBRILLA PARA AUTOM√ìVILES","sku":"SOMBRI-026","price":120000,"image_url":"https://cdn.shopify.com/s/files/1/0707/1979/9484/files/Captura_de_pantalla_2025-10-13_100601.jpg?v=1760360812","description":"Sombrilla para autom√≥viles que protege el interior del calor solar. Mantiene tu auto fresco y previene el desgaste de los interiores.","features":["Protecci√≥n solar","Mantiene fresco","F√°cil de instalar","Tama√±o universal"]},
            {"title":"IRRIGADOR BUCAL","sku":"IRRI-027","price":320000,"image_url":"https://cdn.shopify.com/s/files/1/0707/1979/9484/files/Captura_de_pantalla_2025-10-13_100619.jpg?v=1760360812","description":"Irrigador bucal para una limpieza dental profunda. Elimina restos de comida y placa bacteriana de lugares dif√≠ciles de alcanzar.","features":["Limpieza profunda","M√∫ltiples boquillas","Presi√≥n ajustable","F√°cil de usar"]},
            {"title":"Clip Nasal Anti-Ronquidosüò¥","sku":"CLIPNASAL-029","price":99000,"image_url":"https://cdn.shopify.com/s/files/1/0707/1979/9484/files/Captura_de_pantalla_2025-10-16_085649.jpg?v=1760615829","description":"Clip nasal anti-ronquidos que mejora la respiraci√≥n durante el sue√±o. Soluci√≥n c√≥moda y efectiva para ronquidos leves.","features":["Anti-ronquidos","Mejora respiraci√≥n","C√≥modo","Efectivo"]},
            {"title":"ASIPIRADORA INTELIGENTE","sku":"ASPIRADORAINTE-29","price":279000,"image_url":"https://cdn.shopify.com/s/files/1/0707/1979/9484/files/Imagen_de_WhatsApp_2025-10-16_a_las_11.11.48_140b0bd7.jpg?v=1760623973","description":"Aspiradora inteligente con navegaci√≥n autom√°tica y aplicaci√≥n m√≥vil. Limpia tu hogar de forma aut√≥noma y eficiente.","features":["Navegaci√≥n autom√°tica","App m√≥vil","Limpieza eficiente","Programable"]},
            {"title":"SECADOR DE ROPA PORTATIL","sku":"SECAPORT-030","price":299000,"image_url":"https://cdn.shopify.com/s/files/1/0707/1979/9484/files/Captura_de_pantalla_2025-10-16_112112.jpg?v=1760624483","description":"Secador de ropa port√°til, ideal para viajes o espacios peque√±os. Secado r√°pido y eficiente sin ocupar mucho espacio.","features":["Port√°til","Secado r√°pido","Compacto","Eficiente"]},
            {"title":"üßπ¬°OFERTA ESPECIAL! Plumero Extensible de 2.80 m con descuento exclusivo üí•","sku":"PLUMERO-031","price":120000,"image_url":"https://cdn.shopify.com/s/files/1/0707/1979/9484/files/Captura_de_pantalla_2025-10-30_005208.jpg?v=1762320213","description":"Llega a todos los rincones sin esfuerzo, Limpieza r√°pida y efectiva. Reutilizable y f√°cil de lavar","features":["Extensible 2.80m","Limpieza eficiente","Reutilizable","F√°cil de lavar"]},
            {"title":"Ducha Port√°til Recargable Premium‚Ñ¢","sku":"DUCHA-032","price":220000,"image_url":"https://cdn.shopify.com/s/files/1/0885/3012/5095/files/Imagen_de_WhatsApp_2025-10-17_a_las_17.51.23_4c050991.jpg?v=1760734483","description":"Ducha port√°til recargable premium para camping, playa o emergencias. Presi√≥n constante y f√°cil de transportar.","features":["Recargable","Presi√≥n constante","Port√°til","Premium"]},
            {"title":"Luz Navide√±a con Panel Solar 20 METROS","sku":"LUZNAVIDAD-033","price":159900,"image_url":"https://cdn.shopify.com/s/files/1/0707/1979/9484/files/Imagen_de_WhatsApp_2025-09-25_a_las_01.03.55_e8205f5b.jpg?v=1759102624","description":"Luces navide√±as con panel solar para decoraci√≥n ecol√≥gica. Autom√°ticas y con m√∫ltiples modos de iluminaci√≥n.","features":["Panel solar","Autom√°ticas","M√∫ltiples modos","Ecol√≥gicas"]}
        ];

        // ===== Config =====
        const whatsappNumber = "595993637616";
        const ADMIN_PIN = "9662";

        // ===== Estado =====
        let products = [];
        let currentProduct = null;
        let editingPriceIndex = -1;
        let filteredProducts = [];

        // ===== Utils =====
        function formatPrice(price){
            const n = Number(price);
            if (!Number.isFinite(n)) return '0';
            return new Intl.NumberFormat('es-PY').format(n);
        }

        // ===== Sistema de URLs para productos =====
        function updateURL(sku = null) {
            const baseUrl = window.location.origin + window.location.pathname;
            const newUrl = sku ? `${baseUrl}?product=${encodeURIComponent(sku)}` : baseUrl;
            window.history.replaceState({}, '', newUrl);
        }

        function getProductFromURL() {
            const urlParams = new URLSearchParams(window.location.search);
            const productSKU = urlParams.get('product');
            if (productSKU) {
                return products.find(p => p.sku === productSKU)
                    || DEFAULT_PRODUCTS.find(p => p.sku === productSKU)
                    || null;
            }
            return null;
        }

        function shareProduct(product) {
            const productUrl = `${window.location.origin}${window.location.pathname}?product=${encodeURIComponent(product.sku)}`;
            if (navigator.share) {
                navigator.share({
                    title: product.title,
                    text: product.description,
                    url: productUrl
                }).catch(err => {
                    console.log('Error al compartir:', err);
                    copyToClipboard(productUrl);
                });
            } else {
                copyToClipboard(productUrl);
            }
        }

        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                alert('¬°Enlace copiado al portapapeles! Puedes compartirlo ahora.');
            }).catch(err => {
                const textArea = document.createElement('textarea');
                textArea.value = text;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                alert('¬°Enlace copiado al portapapeles! Puedes compartirlo ahora.');
            });
        }

        // ===== Filtros =====
        function filterProducts(){
            const searchTerm = document.getElementById('search-input').value.toLowerCase();
            const priceFilter = document.getElementById('price-filter').value;

            filteredProducts = !searchTerm ? [...products] :
                products.filter(p => (p.title||'').toLowerCase().includes(searchTerm)
                                  || (p.sku||'').toLowerCase().includes(searchTerm)
                                  || (p.description||'').toLowerCase().includes(searchTerm));

            if (priceFilter === 'low') filteredProducts.sort((a,b)=>a.price-b.price);
            if (priceFilter === 'high') filteredProducts.sort((a,b)=>b.price-a.price);

            generateCatalog();
        }

        // ===== Cat√°logo =====
        function generateCatalog(){
            const container = document.getElementById('products-container');
            if (filteredProducts.length === 0){
                container.innerHTML = `
                    <div class="no-products">
                        <i class="fas fa-search" style="font-size:3rem;margin-bottom:1rem;"></i>
                        <h3>No se encontraron productos</h3>
                        <p>Intenta con otros t√©rminos de b√∫squeda</p>
                    </div>`;
                return;
            }
            container.innerHTML = '';
            filteredProducts.forEach(product=>{
                const productCard = document.createElement('div');
                productCard.className = 'product-card';
                const imageUrl = product.image_url || 'https://via.placeholder.com/300x200?text=Imagen+No+Disponible';
                
                // A√±adir badge de oferta para algunos productos
                const hasBadge = Math.random() > 0.7; // 30% de productos tendr√°n badge
                const badgeText = hasBadge ? (Math.random() > 0.5 ? '¬°Oferta!' : '¬°Nuevo!') : '';
                
                productCard.innerHTML = `
                    ${hasBadge ? `<div class="product-badge">${badgeText}</div>` : ''}
                    <div class="product-image-container">
                        <img src="${imageUrl}" alt="${product.title}" class="product-image"
                             onerror="this.src='https://via.placeholder.com/300x200?text=Error+al+cargar+imagen'">
                    </div>
                    <div class="product-info">
                        <h3 class="product-title">${product.title}</h3>
                        <p class="product-price">Gs. ${formatPrice(product.price)}</p>
                        <p class="product-sku">SKU: ${product.sku}</p>
                        <button class="whatsapp-btn" data-product='${JSON.stringify(product).replace(/'/g,"&#39;")}'>
                            <i class="fab fa-whatsapp"></i> Ver producto
                        </button>
                        <button class="share-btn" data-product='${JSON.stringify(product).replace(/'/g,"&#39;")}'>
                            <i class="fas fa-share-alt"></i> Compartir
                        </button>
                    </div>`;
                container.appendChild(productCard);
            });

            document.querySelectorAll('.whatsapp-btn').forEach(btn=>{
                btn.addEventListener('click', function(){
                    const productData = JSON.parse(this.getAttribute('data-product').replace(/&#39;/g,"'"));
                    openLandingPage(productData);
                });
            });

            document.querySelectorAll('.share-btn').forEach(btn=>{
                btn.addEventListener('click', function(){
                    const productData = JSON.parse(this.getAttribute('data-product').replace(/&#39;/g,"'"));
                    shareProduct(productData);
                });
            });
        }

        // ===== Landing =====
        function openLandingPage(product){
            currentProduct = product;
            updateURL(product.sku);

            document.getElementById('landing-product-title').textContent = product.title;
            document.getElementById('landing-product-name').textContent = product.title;
            document.getElementById('landing-product-price').textContent = `Gs. ${formatPrice(product.price)}`;
            document.getElementById('landing-product-sku').textContent = `SKU: ${product.sku}`;
            const imageUrl = product.image_url || 'https://via.placeholder.com/500x400?text=Imagen+No+Disponible';
            const img = document.getElementById('landing-product-image');
            img.src = imageUrl; img.alt = product.title;

            const descEl = document.getElementById('landing-product-description');
            descEl.innerHTML = `<p>${product.description || 'Producto de alta calidad.'}</p>`;

            const featuresEl = document.getElementById('landing-product-features');
            featuresEl.innerHTML = '';
            const feats = (product.features && product.features.length) ? product.features : [
                "Alta durabilidad y resistencia","Dise√±o ergon√≥mico y moderno","F√°cil de usar y mantener","Garant√≠a incluida"
            ];
            feats.forEach(f=>{ const li=document.createElement('li'); li.textContent=f; featuresEl.appendChild(li); });

            updateTotalPrice();
            document.getElementById('landing-page').style.display='block';
            document.body.style.overflow='hidden';
            
            // Scroll al inicio de la landing
            window.scrollTo(0, 0);
        }

        function updateTotalPrice(){
            const quantity = document.getElementById('customer-quantity').value;
            const totalElement = document.getElementById('total-price');
            if (quantity === 'mas'){ totalElement.textContent='Total a pagar: Consultar por m√°s de 10 unidades'; return; }
            if (quantity && currentProduct){
                const total = Number(currentProduct.price) * parseInt(quantity,10);
                totalElement.textContent = `Total a pagar: Gs. ${formatPrice(total)}`;
            } else totalElement.textContent = 'Total a pagar: Gs. 0';
        }

        function closeLandingPage(){
            updateURL();
            document.getElementById('landing-page').style.display='none';
            document.body.style.overflow='auto';
            document.getElementById('purchase-form').reset();
            document.getElementById('total-price').textContent='Total a pagar: Gs. 0';
            currentProduct = null;
        }

        function submitForm(e){
            e.preventDefault();
            const name = document.getElementById('customer-name').value;
            const phone = document.getElementById('customer-phone').value;
            const quantity = document.getElementById('customer-quantity').value;
            const address = document.getElementById('customer-address').value;
            const city = document.getElementById('customer-city').value;
            const message = document.getElementById('customer-message').value;

            let total = 0, quantityText = quantity;
            if (quantity !== 'mas'){ total = Number(currentProduct.price) * parseInt(quantity,10); quantityText = `${quantity} unidad(es)`; }

            const whatsappMessage = `Hola, estoy interesado en comprar el siguiente producto:\n\n*Producto:* ${currentProduct.title}\n*SKU:* ${currentProduct.sku}\n*Precio unitario:* Gs. ${formatPrice(currentProduct.price)}\n*Cantidad:* ${quantityText}\n${quantity !== 'mas' ? `*Total a pagar:* Gs. ${formatPrice(total)}` : ''}\n\n*Mis datos:*\n- *Nombre:* ${name}\n- *Tel√©fono:* ${phone}\n- *Direcci√≥n:* ${address}\n- *Ciudad:* ${city}\n${message ? `- *Mensaje adicional:* ${message}` : ''}\n\nPor favor, cont√°ctenme para proceder con la compra. ¬°Gracias!`;
            const encoded = encodeURIComponent(whatsappMessage);
            const link = `https://wa.me/${whatsappNumber}?text=${encoded}`;
            window.open(link, '_blank');
            setTimeout(()=>{ closeLandingPage(); alert('¬°Gracias por tu pedido! Te contactaremos pronto por WhatsApp.'); }, 1000);
        }

        // ===== Admin =====
        function openAdminPanel(){
            document.getElementById('admin-panel').style.display='flex';
            document.getElementById('pin-form').style.display='block';
            document.getElementById('add-product-form').style.display='none';
            document.getElementById('pin-error').style.display='none';
            document.querySelectorAll('.pin-digit').forEach(i=>i.value='');
            document.getElementById('pin1').focus();
        }

        function closeAdminPanel(){
            document.getElementById('admin-panel').style.display='none';
            document.getElementById('new-product-form').reset();
            editingPriceIndex = -1;
        }

        function verifyPin(){
            const enteredPin = ['pin1','pin2','pin3','pin4'].map(id=>document.getElementById(id).value).join('');
            if (enteredPin === ADMIN_PIN){
                document.getElementById('pin-form').style.display='none';
                document.getElementById('add-product-form').style.display='block';
                updateAdminProductsList();
            } else {
                document.getElementById('pin-error').style.display='block';
                document.querySelectorAll('.pin-digit').forEach(i=>i.value='');
                document.getElementById('pin1').focus();
            }
        }

        function addNewProduct(e){
            e.preventDefault();

            const title = (document.getElementById('new-product-title').value || '').trim();
            const sku = (document.getElementById('new-product-sku').value || '').trim();
            const priceRaw = document.getElementById('new-product-price').value;
            const image_url = (document.getElementById('new-product-image').value || '').trim();
            const description = (document.getElementById('new-product-description').value || '').trim();
            const featuresRaw = (document.getElementById('new-product-features').value || '').trim();

            const price = Number(priceRaw);
            if (!title || !sku || !Number.isFinite(price) || price < 0 || !image_url || !description) {
                alert('Completa todos los campos y usa un precio v√°lido (n√∫mero ‚â• 0).');
                return;
            }
            if (products.some(p=> p.sku === sku)){
                alert('Ya existe un producto con ese SKU. Usa un SKU √∫nico.');
                return;
            }

            const features = featuresRaw
                ? featuresRaw.split(',').map(f => f.trim()).filter(Boolean)
                : [];

            const newProduct = { title, sku, price, image_url, description, features };

            try {
                products.push(newProduct);
                saveProductsToStorage();
                updateAdminProductsList();
                filteredProducts = [...products];
                generateCatalog();
                document.getElementById('new-product-form').reset();
                alert('Producto agregado correctamente');
            } catch(err){
                console.error('Error agregando producto:', err);
                alert('No se pudo agregar el producto. Revisa la consola para m√°s detalles.');
            }
        }

        function updateAdminProductsList(){
            const container = document.getElementById('admin-products-list');
            container.innerHTML = '';
            products.forEach((product,index)=>{
                const item = document.createElement('div');
                item.className = 'product-item';
                const isEditing = editingPriceIndex === index;
                item.innerHTML = `
                    <div class="product-item-info">
                        <div class="product-item-title">${product.title}</div>
                        <div class="product-item-sku">SKU: ${product.sku}</div>
                        <div class="product-item-price">
                            ${isEditing ?
                                `<div class=\"edit-price-form\">\n                                    <input type=\"number\" class=\"edit-price-input\" value=\"${product.price}\" min=\"0\" id=\"edit-price-${index}\">\n                                    <button class=\"edit-price-btn\" onclick=\"savePrice(${index})\">Guardar</button>\n                                    <button class=\"edit-price-btn\" style=\"background: var(--gray)\" onclick=\"cancelEditPrice()\">Cancelar</button>\n                                </div>` :
                                `Precio: Gs. ${formatPrice(product.price)}`
                            }
                        </div>
                    </div>
                    <div class="admin-buttons">
                        ${!isEditing ? `<button class="edit-btn" onclick="editPrice(${index})"><i class="fas fa-edit"></i> Editar Precio</button>` : ''}
                        <button class="delete-btn" onclick="deleteProduct(${index})"><i class="fas fa-trash"></i> Eliminar</button>
                    </div>`;
                container.appendChild(item);
            });
        }

        function editPrice(index){
            editingPriceIndex = index;
            updateAdminProductsList();
        }

        function savePrice(index){
            const val = document.getElementById(`edit-price-${index}`).value;
            const newPrice = Number(val);
            if (!Number.isFinite(newPrice) || newPrice < 0){
                alert('Por favor ingresa un precio v√°lido');
                return;
            }
            products[index].price = newPrice;
            editingPriceIndex = -1;
            saveProductsToStorage();
            updateAdminProductsList();
            filteredProducts = [...products];
            generateCatalog();
            alert('Precio actualizado correctamente');
        }

        function cancelEditPrice(){
            editingPriceIndex = -1;
            updateAdminProductsList();
        }

        function deleteProduct(index){
            if (confirm(`¬øEliminar "${products[index].title}"?`)){
                products.splice(index,1);
                editingPriceIndex = -1;
                saveProductsToStorage();
                filteredProducts = [...products];
                updateAdminProductsList();
                generateCatalog();
                alert('Producto eliminado correctamente');
            }
        }

        function handlePinInput(){
            const inputs = document.querySelectorAll('.pin-digit');
            inputs.forEach((input,idx)=>{
                input.addEventListener('input',function(){ if(this.value.length===1 && idx<inputs.length-1){ inputs[idx+1].focus(); } });
                input.addEventListener('keydown',function(e){ if(e.key==='Backspace' && this.value.length===0 && idx>0){ inputs[idx-1].focus(); } });
            });
        }

        // ===== Mejoras de sincronizaci√≥n =====
        function mergeMissingDefaultsIntoProducts() {
            const bySku = new Map(products.map(p => [p.sku, p]));
            let added = 0;
            DEFAULT_PRODUCTS.forEach(def => {
                if (!bySku.has(def.sku)) { 
                    products.push(def); 
                    added++; 
                }
            });
            if (added > 0) { 
                saveProductsToStorage(); 
                console.log(`Se agregaron ${added} producto(s) faltante(s) desde DEFAULT_PRODUCTS.`); 
            }
        }

        function maybeResetFromURL() {
            const params = new URLSearchParams(location.search);
            if (params.get('reset') === '1') {
                localStorage.removeItem(STORAGE_KEY);
                sessionStorage.removeItem(STORAGE_KEY);
                products = [...DEFAULT_PRODUCTS];
                saveProductsToStorage();
                console.log('Cat√°logo reseteado desde URL (?reset=1).');
            }
        }

        function addResetButtonAction(){
            const btn = document.getElementById('reset-catalog-btn');
            if (!btn) return;
            btn.addEventListener('click', () => {
                if (confirm('Esto reiniciar√° el cat√°logo al listado por defecto y reemplazar√° los cambios guardados. ¬øContinuar?')){
                    localStorage.removeItem(STORAGE_KEY);
                    sessionStorage.removeItem(STORAGE_KEY);
                    products = [...DEFAULT_PRODUCTS];
                    saveProductsToStorage();
                    filteredProducts = [...products];
                    generateCatalog();
                    updateAdminProductsList();
                    alert('Cat√°logo reiniciado.');
                }
            });
        }

        // ===== Init =====
        document.addEventListener('DOMContentLoaded', function(){
            maybeResetFromURL();

            const loaded = loadProductsFromStorage();
            if (!loaded || products.length === 0) {
                products = [...DEFAULT_PRODUCTS];
                saveProductsToStorage();
            }

            // Asegura que el "Plumero" y cualquier nuevo default aparezcan
            mergeMissingDefaultsIntoProducts();

            filteredProducts = [...products];
            generateCatalog();

            const urlProduct = getProductFromURL();
            if (urlProduct) {
                openLandingPage(urlProduct);
            }

            // Listeners principales
            document.getElementById('close-landing').addEventListener('click', closeLandingPage);
            document.getElementById('purchase-form').addEventListener('submit', submitForm);
            document.getElementById('customer-quantity').addEventListener('change', updateTotalPrice);
            document.getElementById('share-product-btn').addEventListener('click', function() { if (currentProduct) shareProduct(currentProduct); });

            document.getElementById('landing-page').addEventListener('click', function(e){ if(e.target===this){ closeLandingPage(); }});
            document.getElementById('admin-panel').addEventListener('click', function(e){ if(e.target===this){ closeAdminPanel(); }});

            document.querySelector('.landing-content')?.addEventListener('click', (e)=> e.stopPropagation());
            document.querySelector('.admin-content')?.addEventListener('click', (e)=> e.stopPropagation());

            document.getElementById('admin-btn').addEventListener('click', openAdminPanel);
            document.getElementById('close-admin').addEventListener('click', closeAdminPanel);
            document.getElementById('verify-pin').addEventListener('click', verifyPin);
            document.getElementById('new-product-form').addEventListener('submit', addNewProduct);
            addResetButtonAction();
            handlePinInput();

            document.getElementById('search-input').addEventListener('input', filterProducts);
            document.getElementById('price-filter').addEventListener('change', filterProducts);
            
            // Debug: Mostrar productos cargados en consola
            console.log("Productos cargados:", products);
            console.log("Producto V-SHAPED:", products.find(p => p.sku === "V-S-002"));
        });
    </script>
</body>
</html>

